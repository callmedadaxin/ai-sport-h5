# 页面性能优化方案

本文档列出了项目中可进行性能优化的内容和详细修改方式，按优先级排序。

---

## 目录

- [一、构建配置优化](#一构建配置优化)
- [二、图片资源优化](#二图片资源优化)
- [三、API 请求优化](#三api-请求优化)
- [四、路由优化](#四路由优化)
- [五、组件性能优化](#五组件性能优化)
- [六、第三方库优化](#六第三方库优化)
- [七、Nginx 配置优化](#七nginx-配置优化)
- [八、优化优先级汇总](#八优化优先级汇总)

---

## 一、构建配置优化

### 1.1 文件：`vite.config.js`

**当前问题**：配置过于简单，缺少代码分割、压缩等优化配置。

**修改方式**：

```javascript
// vite.config.js
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'

export default defineConfig({
  plugins: [vue()],
  server: {
    port: 5173,
    proxy: {
      '/api': {
        target: 'https://wanmeiyundonghui.jiuzhuokeji.cn',
        changeOrigin: true,
      },
    },
  },

  // ===== 新增构建优化配置 =====
  build: {
    // 设置目标浏览器，启用更激进的压缩
    target: 'es2015',

    // 开启 minify
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true, // 生产环境移除 console
        drop_debugger: true, // 生产环境移除 debugger
      },
    },

    // 代码分割配置
    rollupOptions: {
      output: {
        // 手动分割代码块
        manualChunks: {
          // Vue 全家桶单独打包
          'vue-vendor': ['vue', 'vue-router', 'pinia'],
          // 工具库单独打包
          'utils-vendor': ['axios'],
          // 图片处理相关库单独打包（较大）
          'image-vendor': ['cropperjs', 'html2canvas', 'qrcode'],
        },
        // 静态资源文件名格式
        chunkFileNames: 'assets/js/[name]-[hash].js',
        entryFileNames: 'assets/js/[name]-[hash].js',
        assetFileNames: 'assets/[ext]/[name]-[hash].[ext]',
      },
    },

    // 提高 chunk 大小警告阈值
    chunkSizeWarningLimit: 1000,

    // CSS 代码分割
    cssCodeSplit: true,
  },

  // 预加载配置
  preview: {
    port: 4173,
  },
})
```

---

## 二、图片资源优化

### 2.1 文件：`src/views/Home.vue`

**当前问题**：
1. 图片仅使用 `loading="lazy"`，缺少预加载
2. 模板列表数据未缓存，每次进入都重新请求

**修改方式**：

```vue
<script setup>
import { ref, onMounted, inject } from 'vue'
import { useRouter } from 'vue-router'
import { useUserStore } from '../stores/user'
import { templateApi } from '../api'
import { initWxShareFromApi } from '../utils/wechatShare'
// ... 其他 imports

const templates = ref([])

// ===== 优化1：添加数据缓存 =====
const CACHE_KEY = 'template_list_cache'
const CACHE_EXPIRE = 5 * 60 * 1000 // 5分钟缓存

function getCachedTemplates() {
  try {
    const cached = sessionStorage.getItem(CACHE_KEY)
    if (!cached) return null
    const { data, expireTime } = JSON.parse(cached)
    if (Date.now() < expireTime) return data
    sessionStorage.removeItem(CACHE_KEY)
    return null
  } catch {
    return null
  }
}

function setCachedTemplates(data) {
  try {
    sessionStorage.setItem(CACHE_KEY, JSON.stringify({
      data,
      expireTime: Date.now() + CACHE_EXPIRE
    }))
  } catch {}
}

// ===== 优化2：请求时优先使用缓存 =====
onMounted(() => {
  doShare()

  // 先尝试从缓存读取
  const cached = getCachedTemplates()
  if (cached && cached.length > 0) {
    templates.value = cached
    return
  }

  // 无缓存则请求
  templateApi
    .list()
    .then(res => {
      const list = res.list || res || []
      templates.value = list
      setCachedTemplates(list)
    })
    .catch(() => {
      templates.value = []
    })
})

// ===== 优化3：图片预加载 =====
function preloadImage(src) {
  return new Promise((resolve, reject) => {
    const img = new Image()
    img.onload = () => resolve(img)
    img.onerror = reject
    img.src = src
  })
}

// 预加载前几张模板封面
function preloadTemplateImages(list) {
  list.slice(0, 4).forEach(t => {
    if (t.cover) preloadImage(t.cover).catch(() => {})
  })
}
</script>

<template>
  <!-- ... 其他模板 ... -->

  <!-- ===== 优化4：图片添加 decode 异步解码 ===== -->
  <img
    :src="t.cover"
    :alt="t.title"
    class="thumb"
    loading="lazy"
    decoding="async"
  />

  <!-- ... -->
</template>
```

### 2.2 静态图片优化

**文件位置**：`src/assets/image/`

**当前问题**：图片体积过大（如 banner.png 约 2.6MB）

**修改方式**：

1. **转换为 WebP 格式**（可减少 60%-80% 体积）
   ```bash
   # 使用工具转换（如 squoosh、imagemin）
   npx squoosh-cli banner.png --webp auto -d ./src/assets/image/
   ```

2. **代码中使用 WebP 并提供回退**：

```vue
<!-- 在 Home.vue 中修改 banner 背景使用方式 -->
<script setup>
// 检测浏览器是否支持 WebP
const supportsWebP = ref(false)

onMounted(() => {
  // WebP 检测
  const canvas = document.createElement('canvas')
  canvas.width = canvas.height = 1
  supportsWebP.value = canvas.toDataURL('image/webp').startsWith('data:image/webp')
})
</script>

<template>
  <!-- 使用 picture 标签提供格式回退 -->
  <picture>
    <source srcset="../assets/image/banner.webp" type="image/webp" />
    <img src="../assets/image/banner.png" alt="" class="banner-img" />
  </picture>
</template>
```

3. **CSS 背景图优化**（修改 Home.vue 样式）：

```css
/* 使用 CSS 变量动态设置背景 */
.banner {
  position: relative;
  min-height: 4.5rem;
  /* 使用渐进式背景加载 */
  background-image: url('../assets/image/banner-placeholder.png');
  background-size: cover;
  background-position: center;
}

/* 高清图加载后替换 */
.banner.loaded {
  background-image: url('../assets/image/banner.webp'),
                    url('../assets/image/banner.png');
}
```

---

## 三、API 请求优化

### 3.1 文件：`src/api/index.js`

**当前问题**：
1. 无请求缓存机制
2. 无请求防抖/节流

**修改方式**：

```javascript
// src/api/index.js
import axios from 'axios'
import router from '../router'
import { useUserStore } from '../stores/user'
import { showToast } from '../utils/toast'

const request = axios.create({
  baseURL: '/api',
  timeout: 10000,
})

// ===== 优化1：添加请求缓存 =====
const cacheMap = new Map()

function createCacheKey(config) {
  return `${config.method}:${config.url}:${JSON.stringify(config.params)}`
}

// 缓存拦截器（仅对 GET 请求生效）
request.interceptors.request.use((config) => {
  // 仅缓存 GET 请求
  if (config.method === 'get' && config.cache !== false) {
    const cacheKey = createCacheKey(config)
    const cached = cacheMap.get(cacheKey)

    if (cached && Date.now() - cached.time < (config.cacheTime || 60000)) {
      // 返回缓存的 Promise
      return Promise.reject({ __cached: true, data: cached.data })
    }
  }

  // 原有的 token 处理逻辑
  const url = config.url || ''
  if (url.startsWith('/auth/login') || url.startsWith('/auth/sendCode')) return config
  const token = useUserStore().token
  if (token) config.headers.Authorization = `Bearer ${token}`
  return config
})

// 响应拦截器处理缓存
request.interceptors.response.use(
  (res) => {
    const body = res.data
    if (body.code === 0) {
      // 缓存成功的 GET 响应
      if (res.config.method === 'get' && res.config.cache !== false) {
        const cacheKey = createCacheKey(res.config)
        cacheMap.set(cacheKey, { data: body.data, time: Date.now() })
      }
      return body.data
    }
    const err = new Error(body.message || '请求失败')
    err.code = body.code
    return Promise.reject(err)
  },
  (err) => {
    // 处理缓存命中
    if (err.__cached) {
      return Promise.resolve(err.data)
    }
    // ... 原有错误处理逻辑
    const status = err.response?.status
    const data = err.response?.data
    const msg = data?.message || err.message
    const e = new Error(msg)
    e.code = data?.code

    if (status === 401) {
      useUserStore().setUser({})
      showToast('未登录或登录已过期，请先登录')
      router.push('/')
      return Promise.reject(e)
    }
    if (data?.code === 40100) useUserStore().setUser({})
    return Promise.reject(e)
  }
)

// ===== 优化2：添加防抖请求工具 =====
const pendingRequests = new Map()

export function debounceRequest(key, requestFn, delay = 300) {
  return new Promise((resolve, reject) => {
    // 取消之前的请求
    if (pendingRequests.has(key)) {
      clearTimeout(pendingRequests.get(key))
    }

    const timer = setTimeout(async () => {
      pendingRequests.delete(key)
      try {
        const result = await requestFn()
        resolve(result)
      } catch (err) {
        reject(err)
      }
    }, delay)

    pendingRequests.set(key, timer)
  })
}

// ===== 优化3：大文件上传分片 =====
export async function uploadLargeFile(file, options = {}) {
  const chunkSize = options.chunkSize || 1024 * 1024 // 默认 1MB
  const totalChunks = Math.ceil(file.size / chunkSize)

  for (let i = 0; i < totalChunks; i++) {
    const start = i * chunkSize
    const end = Math.min(start + chunkSize, file.size)
    const chunk = file.slice(start, end)

    const formData = new FormData()
    formData.append('file', chunk)
    formData.append('chunkIndex', i)
    formData.append('totalChunks', totalChunks)
    formData.append('fileName', file.name)

    await request.post('/upload/chunk', formData, {
      onUploadProgress: options.onProgress
    })
  }

  // 合并分片
  return request.post('/upload/merge', { fileName: file.name, totalChunks })
}

export const authApi = {
  sendCode(data) {
    return request.post('/auth/sendCode', data)
  },
  login(data) {
    return request.post('/auth/login', data)
  },
}

export const templateApi = {
  // 添加缓存配置
  list(options = {}) {
    return request.get('/template/list', { cache: true, cacheTime: 300000, ...options })
  },
  detail(id) {
    return request.get(`/template/${id}`)
  },
}

export const worksApi = {
  list() {
    return request.get('/works/list')
  },
  detail(id) {
    return request.get(`/works/${id}`)
  },
  submit(data) {
    return request.post('/works/submit', data)
  },
  refreshProgress(taskId) {
    return request.get(`/works/progress/${taskId}`)
  },
}

export const shareApi = {
  getWechatSignature(url) {
    return request.get('/share/wechat/signature', { params: { url } })
  },
  getDouyinSignature() {
    return request.get('/share/douyin/signature')
  },
  uploadPoster(dataUrl) {
    return request.post('/share/douyin/upload', { image: dataUrl })
  },
}

export default request
```

---

## 四、路由优化

### 4.1 文件：`src/router/index.js`

**当前问题**：
1. 路由懒加载已有，但缺少预加载
2. 无页面切换动画优化

**修改方式**：

```javascript
// src/router/index.js
import { createRouter, createWebHistory } from 'vue-router'

const routes = [
  { path: '/', name: 'Home', component: () => import('../views/Home.vue'), meta: { title: '首页', preload: true } },
  { path: '/template/:id', name: 'TemplateDetail', component: () => import('../views/TemplateDetail.vue'), meta: { title: '模板详情' } },
  { path: '/works', name: 'Works', component: () => import('../views/Works.vue'), meta: { title: '作品中心' } },
  { path: '/making/:taskId', name: 'Making', component: () => import('../views/Making.vue'), meta: { title: '制作中' } },
  { path: '/works/:id', name: 'WorkDetail', component: () => import('../views/WorkDetail.vue'), meta: { title: '预览视频' } },
  { path: '/share/:id', name: 'Share', component: () => import('../views/Share.vue'), meta: { title: '分享' } },
  { path: '/s/:id', name: 'ShareLanding', component: () => import('../views/ShareLanding.vue'), meta: { title: '分享' } },
]

const router = createRouter({
  history: createWebHistory(),
  routes,
  // 滚动行为优化
  scrollBehavior(to, from, savedPosition) {
    if (savedPosition) {
      return savedPosition
    }
    if (to.hash) {
      return { el: to.hash, behavior: 'smooth' }
    }
    return { top: 0, behavior: 'smooth' }
  },
})

router.afterEach((to) => {
  if (to.meta.title) document.title = to.meta.title + ' - 皖美运动汇'
})

// ===== 优化1：路由预加载 =====
// 在首页加载完成后，预加载标记为 preload 的路由
export function preloadRoutes() {
  routes.forEach(route => {
    if (route.meta?.preload && typeof route.component === 'function') {
      route.component() // 触发动态 import
    }
  })
}

// ===== 优化2：空闲时预加载所有路由 =====
export function idlePreloadRoutes() {
  if ('requestIdleCallback' in window) {
    requestIdleCallback(() => {
      routes.forEach(route => {
        if (typeof route.component === 'function') {
          route.component().catch(() => {})
        }
      })
    })
  } else {
    // 降级处理
    setTimeout(preloadRoutes, 2000)
  }
}

export default router
```

**在 App.vue 中调用预加载**：

```vue
<!-- src/App.vue -->
<script setup>
import { onMounted } from 'vue'
import { idlePreloadRoutes } from './router'

onMounted(() => {
  // 空闲时预加载路由
  idlePreloadRoutes()
})
</script>
```

---

## 五、组件性能优化

### 5.1 文件：`src/views/Upload.vue`

**当前问题**：
1. Cropper 实例可能在组件卸载时未完全清理
2. 裁剪后生成 dataURL 可能过大

**修改方式**：

```vue
<script setup>
import { ref, computed, watch, nextTick, onUnmounted } from 'vue' // 添加 onUnmounted
import Cropper from 'cropperjs'
import 'cropperjs/dist/cropper.css'
import BottomSheet from '../components/BottomSheet.vue'
import { templateApi, worksApi } from '../api'

// ... 其他代码 ...

let cropperInstance = null

// ===== 优化1：确保组件卸载时销毁 Cropper 实例 =====
onUnmounted(() => {
  if (cropperInstance) {
    cropperInstance.destroy()
    cropperInstance = null
  }
})

// ===== 优化2：裁剪时优先生成 Blob 而非 dataURL =====
function confirmCrop() {
  if (!cropperInstance) return

  // 使用 Blob 替代 dataURL，减少内存占用
  cropperInstance.getCroppedCanvas({
    width: 512,
    height: 512,
    imageSmoothingEnabled: true,
    imageSmoothingQuality: 'high'
  }).toBlob(
    (blob) => {
      if (!blob) return

      // 创建临时 URL 用于预览
      const blobUrl = URL.createObjectURL(blob)
      photoList.value.push(blobUrl)
      selectedIndex.value = photoList.value.length - 1

      // 存储 blob 引用用于后续上传
      photoBlobs.value.push(blob)

      closeCrop()
    },
    'image/jpeg',
    0.85 // 压缩质量
  )
}

// 存储 blob 引用
const photoBlobs = ref([])

// ===== 优化3：上传时直接使用 Blob =====
function submit() {
  if (!currentPhoto.value || submitLoading.value) return

  const idx = selectedIndex.value
  const blob = photoBlobs.value[idx]

  // 如果有 blob，转换为 base64 上传（或者后端支持直接上传 blob）
  if (blob) {
    const reader = new FileReader()
    reader.onload = () => {
      doSubmit(reader.result)
    }
    reader.readAsDataURL(blob)
  } else {
    // 降级：使用 dataURL
    doSubmit(currentPhoto.value)
  }
}

function doSubmit(imageData) {
  const id = props.templateId
  try {
    sessionStorage.setItem('making_avatar', imageData)
  } catch (_) {}

  submitLoading.value = true
  worksApi
    .submit({ templateId: id, image: imageData })
    .then(res => {
      emit('update:modelValue', false)
      emit('success', { taskId: res.taskId })
    })
    .catch(err => {
      alert(err?.message || '提交失败')
    })
    .finally(() => {
      submitLoading.value = false
    })
}

// ===== 优化4：清理 Blob URL =====
watch(() => props.modelValue, (visible) => {
  if (!visible) {
    // 清理 blob URL
    photoList.value.forEach(url => {
      if (url.startsWith('blob:')) {
        URL.revokeObjectURL(url)
      }
    })
    photoList.value = []
    photoBlobs.value = []
    selectedIndex.value = -1
  }
})
</script>
```

### 5.2 文件：`src/components/SharePanel.vue`

**当前问题**：html2canvas 在移动端性能较差

**修改方式**：

```vue
<script setup>
import { ref, onMounted, watch } from 'vue'
import QRCode from 'qrcode'
import html2canvas from 'html2canvas'
import { shareApi } from '../api'
import { buildDouyinShareSchema, shareImageToDouyin } from '../utils/douyinShare'
import { initWxShareFromApi } from '../utils/wechatShare'
import { showToast } from '../utils/toast'

// ... 其他代码 ...

// ===== 优化1：html2canvas 性能优化 =====
function generatePoster() {
  if (!posterEl.value) return
  posterImageUrl.value = ''

  const el = posterEl.value
  const imgs = el.querySelectorAll('img')

  // 图片预加载
  const loadPromises = Array.from(imgs).map(
    img =>
      new Promise(resolve => {
        if (!img.src || img.src === window.location.href) {
          resolve()
          return
        }
        if (img.complete && img.naturalHeight > 0) {
          resolve()
          return
        }
        img.onload = () => resolve()
        img.onerror = () => resolve()
        // 缩短超时时间
        setTimeout(resolve, 1500)
      })
  )

  Promise.all(loadPromises)
    .then(() => {
      // 等待一帧渲染
      return new Promise(r => requestAnimationFrame(r))
    })
    .then(() => {
      // ===== 关键优化：html2canvas 配置 =====
      return html2canvas(el, {
        useCORS: true,
        allowTaint: true,
        scale: 1, // 保持 1 倍缩放，减少生成图片尺寸
        backgroundColor: '#fff0e3',
        logging: false, // 关闭日志
        // 优化渲染性能
        foreignObjectRendering: false,
        // 忽略某些元素
        ignoreElements: (element) => {
          return element.classList.contains('ignore-in-canvas')
        },
      })
    })
    .then(canvas => {
      // ===== 优化2：压缩输出图片 =====
      posterImageUrl.value = canvas.toDataURL('image/jpeg', 0.8) // 使用 JPEG 压缩
    })
    .catch(() => {
      posterImageUrl.value = ''
      showToast('生成失败')
    })
}

// ===== 优化3：海报缓存 =====
const posterCache = new Map()

function generatePosterWithCache(workId) {
  if (posterCache.has(workId)) {
    posterImageUrl.value = posterCache.get(workId)
    return
  }

  generatePoster()

  // 缓存结果
  watch(posterImageUrl, (url) => {
    if (url) {
      posterCache.set(workId, url)
      // 限制缓存大小
      if (posterCache.size > 10) {
        const firstKey = posterCache.keys().next().value
        posterCache.delete(firstKey)
      }
    }
  })
}

// ===== 优化4：使用 Web Worker 生成海报 =====
// 创建 worker.js 文件（可选，复杂场景使用）
// 将 html2canvas 逻辑放入 worker 中执行
</script>
```

---

## 六、第三方库优化

### 6.1 按需引入优化

**文件**：`src/main.js` 或各组件

**修改方式**：

```javascript
// 如果使用 Element Plus 或其他 UI 库，按需引入
// 示例（假设使用 Element Plus）：

// 方式1：手动按需引入
import { ElButton, ElInput } from 'element-plus'
import 'element-plus/theme-chalk/el-button.css'
import 'element-plus/theme-chalk/el-input.css'

// 方式2：使用 unplugin-vue-components 自动按需引入
// vite.config.js
import Components from 'unplugin-vue-components/vite'
import { ElementPlusResolver } from 'unplugin-vue-components/resolvers'

export default defineConfig({
  plugins: [
    Components({
      resolvers: [ElementPlusResolver()],
    }),
  ],
})
```

### 6.2 Cropper.js 优化

**文件**：`src/views/Upload.vue`

```vue
<script setup>
// ===== 优化：延迟加载 Cropper.js =====
let Cropper = null

async function initCropper() {
  if (!Cropper) {
    // 动态导入
    const module = await import('cropperjs')
    Cropper = module.default
    await import('cropperjs/dist/cropper.css')
  }

  // 初始化裁剪器
  if (!cropImgRef.value) return

  cropperInstance = new Cropper(cropImgRef.value, {
    // 精简配置，减少计算
    aspectRatio: 1,
    viewMode: 1, // 从 3 改为 1，减少约束计算
    dragMode: 'move',
    autoCropArea: 1,
    restore: false,
    guides: false,
    center: false, // 关闭中心线
    highlight: false,
    cropBoxMovable: false,
    cropBoxResizable: false,
    zoomable: true,
    zoomOnTouch: true,
    zoomOnWheel: false, // 关闭滚轮缩放
    scalable: false, // 关闭缩放
    rotatable: false,
    toggleDragModeOnDblclick: false,
  })
}

// 在需要时调用
watch(cropImageSrc, async (src) => {
  if (!src) {
    if (cropperInstance) {
      cropperInstance.destroy()
      cropperInstance = null
    }
    return
  }

  await nextTick()
  await initCropper()
})
</script>
```

---

## 七、Nginx 配置优化

### 7.1 文件：`nginx/h5.conf`

**修改方式**：

```nginx
server {
    listen 80;
    server_name your-domain.com;

    root /usr/share/nginx/html;
    index index.html;

    # ===== 优化1：启用 Gzip 压缩 =====
    gzip on;
    gzip_vary on;
    gzip_min_length 1024;
    gzip_proxied any;
    gzip_comp_level 6;
    gzip_types
        text/plain
        text/css
        text/xml
        text/javascript
        application/json
        application/javascript
        application/xml
        application/xml+rss
        image/svg+xml;

    # ===== 优化2：启用 Brotli 压缩（如果安装了 ngx_brotli）=====
    # brotli on;
    # brotli_comp_level 6;
    # brotli_types text/plain text/css application/javascript application/json;

    # ===== 优化3：静态资源缓存 =====
    # JS/CSS 文件长期缓存（因为使用了 hash 文件名）
    location ~* \.(js|css)$ {
        expires 1y;
        add_header Cache-Control "public, max-age=31536000, immutable";
    }

    # 图片资源缓存
    location ~* \.(png|jpg|jpeg|gif|ico|webp|svg)$ {
        expires 30d;
        add_header Cache-Control "public, max-age=2592000";
    }

    # 字体缓存
    location ~* \.(woff|woff2|ttf|otf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, max-age=31536000, immutable";
    }

    # ===== 优化4：HTML 不缓存（确保更新及时）=====
    location ~* \.html$ {
        expires -1;
        add_header Cache-Control "no-cache, no-store, must-revalidate";
    }

    # ===== 优化5：API 代理 =====
    location /api/ {
        proxy_pass https://wanmeiyundonghui.jiuzhuokeji.cn/api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;

        # 代理缓存（可选）
        proxy_cache_valid 200 5m;
    }

    # ===== 优化6：SPA 路由支持 =====
    location / {
        try_files $uri $uri/ /index.html;
    }

    # ===== 优化7：错误页面 =====
    error_page 404 /index.html;
    error_page 500 502 503 504 /50x.html;
}
```

---

## 八、优化优先级汇总

### 高优先级（建议立即实施）

| 序号 | 优化项 | 文件 | 预期效果 |
|------|--------|------|----------|
| 1 | 图片压缩 + WebP 转换 | `src/assets/image/*` | 减少 60%-80% 图片体积 |
| 2 | 构建配置优化 | `vite.config.js` | 减少 30%-50% JS 体积 |
| 3 | API 请求缓存 | `src/api/index.js` | 减少重复请求，提升响应速度 |
| 4 | 模板列表缓存 | `src/views/Home.vue` | 首页加载提速 |

### 中优先级（建议近期实施）

| 序号 | 优化项 | 文件 | 预期效果 |
|------|--------|------|----------|
| 5 | Cropper 内存管理 | `src/views/Upload.vue` | 防止内存泄漏 |
| 6 | html2canvas 性能优化 | `src/components/SharePanel.vue` | 海报生成提速 |
| 7 | 路由预加载 | `src/router/index.js` | 页面切换更流畅 |
| 8 | Nginx 缓存配置 | `nginx/h5.conf` | 静态资源加载提速 |

### 低优先级（可选实施）

| 序号 | 优化项 | 文件 | 预期效果 |
|------|--------|------|----------|
| 9 | 第三方库按需引入 | 多文件 | 减少打包体积 |
| 10 | Web Worker 海报生成 | `src/components/SharePanel.vue` | 主线程不阻塞 |
| 11 | 大文件分片上传 | `src/api/index.js` | 大图上传更稳定 |

---

## 实施建议

1. **分阶段实施**：按优先级逐步优化，每次优化后进行性能测试
2. **性能监控**：建议添加 Lighthouse 或 Web Vitals 监控，量化优化效果
3. **AB 测试**：重大优化建议先进行灰度测试

---

*文档更新时间：2026-02-27*
